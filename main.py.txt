import streamlit as st
import google.generativeai as genai

st.set_page_config(page_title="Dreamz Hunter AI", page_icon="ğŸ•µï¸â€â™‚ï¸", layout="centered")
st.title("ğŸ¬ Dreamz Hunter AI Assistant")
st.caption("Your personal co-writer for dark, cinematic suspense scripts, and 3D-style Hindi moral tales.")

with st.sidebar:
    st.header("âš™ï¸ Setup")
    api_key = st.text_input("Enter your Google Gemini API Key:", type="password")
    st.markdown("[Get your free API key here](https://aistudio.google.com/app/apikey)")

if api_key:
    genai.configure(api_key=api_key)
    model = genai.GenerativeModel('gemini-1.5-flash')

    if "chat_session" not in st.session_state:
        system_instruction = "Tumhara naam Dreamz Hunter AI hai. Tumhe mere YouTube channel ke liye dark, mysterious, aur suspenseful documentaries likhni hain. Sath hi, 3D animation style ki Hindi moral stories bhi likhni hain. Tumhara tone hamesha engaging, factual, aur thriller jaisa hona chahiye."
        st.session_state.chat_session = model.start_chat(history=[])
        st.session_state.chat_session.send_message(system_instruction)

    for message in st.session_state.chat_session.history[2:]:
        role = "Assistant ğŸ¤–" if message.role == "model" else "You ğŸ‘¤"
        with st.chat_message(role):
            st.markdown(message.parts[0].text)

    user_prompt = st.chat_input("Ask me to write a script or story...")
    
    if user_prompt:
        with st.chat_message("You ğŸ‘¤"):
            st.markdown(user_prompt)
        with st.chat_message("Assistant ğŸ¤–"):
            response = st.session_state.chat_session.send_message(user_prompt)
            st.markdown(response.text)
else:
    st.warning("ğŸ‘ˆ Please enter your Gemini API Key in the sidebar to wake up the assistant.")